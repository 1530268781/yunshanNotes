### **1.物理层设备**

一、中继器

- 中继器又称转发器，主要功能是将信号整形并放大再转发出去，以消除信号经过一长段电缆后，因噪声或其他原因而造成的失真和衰减，使信号的波形和强度达到所需要的要求，进而扩大网络传输的距离。其原理是信号再生（而非简单地将衰减的信号放大）。中继器有两个端口，数据从一个端口输入，再从另一个端口发出。端口仅作用于信号的电气部分，而不管数据中是否有错误数据或不适于网段的数据。
- 中继器是局域网环境下用来扩大网络规模的最简单、最廉价的互联设备。使用中继器连接的几个网段仍然是一个局域网。一般情况下，中继器的两端连接的是相同的媒体，但有的中继器也可以完成不同媒体的转接工作。但由于中继器工作在物理层，因此它不能连接两个具有不同速率的局域网。中继器两端的网络部分是网段，而不是子网。中继器若出现故障，对相邻两个网段的工作都将产生影响。
- 从理论上讲，中继器的使用数目是无限的，网络因而也可以无限延长。但事实上这不可能，因为网络标准中对信号的延迟范围做了具体的规定，中继器只能在此规定范围内进行有效的工作．否则会引起网络故障。

> ❝ 【小知识】在采用粗同轴电缆的10BASE5 以太网规范中，互相串联的中继器的个数不能超过4 个，而且用4 个中继器串联的5 段通信介质中只有3 段可以挂接计算机，其余两段只能用作扩展通信范围的链路段，不能挂接计算机。这就是所谓的"5-4-3 规则”。
> ❞
> ❝ 【注意】：放大器和中继器都起放大作用，只不过放大器放大的是模拟信号，原理是将衰减的信 号放大，而中继器放大的是数字信号，原理是将衰减的信号整形再生。如果某个网络设备具有存 储转发的功能，那么可以认为它能连接两个不同的协议，如果该网络设备没有存储转发功能，那 么认为它不能连接两个不同的协议。中继器是没有存储转发功能的，因此它不能连接两个速率不 同的网段，中继器两瑞的网段一定要使用同一个协议。
> ❞

------

二、集线器

- 集线器(Hub) 实质上是一个多端口的中继器，它也工作在物理层。当Hub工作时，一个端口接收到数据信号后，由于信号在从端口到Hub 的传输过程中已有衰减，所以Hub便将该信号进行整形放大，使之再生（恢复）到发送时的状态，紧接着转发到其他所有（除输入端口外）处于工作状态的端口。如果同时有两个或多个端口输入，那么输出时会发生冲突，致使这些数据都无效。从Hub 的工作方式可以看出，它在网络中只起信号放大和转发作用，目的是扩大网络的传输范围，而不具备信号的定向传送能力，即信号传输的方向是固定的，是一个标准的共享式设备。
- Hub 主要使用双绞线组建共享网络，是从服务器连接到桌面的最经济方案。在交换式网络中，Hub 直接与交换机相连，将交换机端口的数据送到桌面上。使用Hub 组网灵活，它把所有结点的通信集中在以其为中心的结点上，对结点相连的工作站进行集中管理，不让出问题的工作站影响整个网络的正常运行，并且用户的加入和退出也很自由。
- 由Hub组成的网络是共享式网络，但逻辑上仍是一个总线网。Hub的每个端口连接的网络部分是同一个网络的不同网段。同时Hub也只能在半双工状态下工作，网络的吞吐率因而受到限制。

> ❝ 【注意】：多台计算机必然会发生同时通信的情形，因此集线器不能分割冲突域，所有集线器的端口都属于同一个冲突域。集线器在一个时钟周期中只能传输一组信息，如果一台集线器连接的机器数目较多，且多台机器经常需要同时通信，那么将导致信息碰撞，使得集线器的工作效率很差。比如，一个带宽为l0Mb/s 的集线器上连接了8 台计算机，当这8 台计算机同时工作时，每台计算机真正所拥有的带宽为10/8Mb/s = l.25Mb/s 。
> ❞

### **2.数据链路层设备**

一、网桥的概念及其基本原理

- 两个或多个以太网通过网桥连接后，就成为一个覆盖范围更大的以太网，而原来的每个以太网就称为一个网段。网桥工作在链路层的MAC子层，可以使以太网各网段成为隔离开的冲突域。如果把网桥换成工作在物理层的转发器，那么就没有这种过滤通信量的功能。由于各网段相对独立，因此一个网段的故障不会影响到另一个网段的运行。

> ❝ 【注意】：网桥处理数据的对象是帧，所以它是工作在数据链路层的设备，中继器、放大器处理数据的对象是信号，所以它是工作在物理层的设备。
> ❞

- 网络l和网络2 通过网桥连接后，网桥接收网络l发送的数据帧，检查数据帧中的地址，如果是网络2的地址，那么就转发给网络2; 如果是网络l的地址，那么就将其丢弃，因为源站和目的站处在同一个网段，目的站能够直接收到这个帧而不需要借助网桥转发。
- 如图所示，设每个网段的数据率都是l0Mb/s, 那么三个网段合起来的最大吞吐量就变成了30Mb/s 。如果把两个网桥换成集线器或转发器，那么整个网络仍然是一个碰撞域（即冲突域），当A 和B 通信时，所有其他站点都不能通信，整个碰撞域的最大吞吐量仍然是l0Mb/s 。



![b76e9438897024ae968d8124fa7640e1.png](https://img-blog.csdnimg.cn/img_convert/b76e9438897024ae968d8124fa7640e1.png)

> ❝ 【网桥的基本特点】：1)网桥必须具备寻址和路径选择能力，以确定帧的传输方向；2)从源网络接收帧，以目的网络的介质访问控制协议向目的网络转发该帧；3)网桥在不同或相同类型的LAN之间存储并转发帧，必要时还进行链路层上的协议转换。【注意】，一般情况下，存储转发类设备都能进行协议转换，即连接的两个网段可以使用不同的协议；4)网桥对接收到的帧不做任何修改，或只对帧的封装格式做很少的修改；5)网桥可以通过执行帧翻译互联不同类型的局域网，即把原协议的信息段的内容作为另一种协议的信息部分封装在帧中；6)网桥应有足够大的缓冲空间，因为在短时间内帧的到达速率可能高于转发速率。
> ❞
> ❝ 【网桥的优点】：1)能过滤通信量；2)扩大了物理范围；3)可使用不同的物理层；4)可互联不同类型的局域网；5)提高了可靠性和性能
> ❞
> ❝ 【网桥的缺点】：1)增大了时延（存储转发）2)MAC子层没有流量控制功能（流量控制要用到编号机制，编号机制的实现在LLC子层）3)不同的MAC子层的网段桥接在一起时，需要进行帧格式的转换4)网桥只适合用户数不多和通信量不大的局域网，否则有时还会因传播过多的广播信息而产生网络拥塞，这就是所谓的网络风暴
> ❞
> ❝ 【网桥的分类】：根据路径选择算法的不同，可将网桥分为透明网桥和源路由网桥。前者选择的不是最佳路由，后者选择的是最佳路由。
> ❞

二、局域网交换机及其工作原理

1、局域网交换机

桥接器的主要限制是在任一时刻通常只能执行一个帧的转发操作，于是出现了局域网交换 机，又称以太网交换机。从本质上说，以太网交换机是一个多端口的网桥，它工作在数据链路层。交换机能经济地将网络分成小的冲突域，为每个工作站提供更高的带宽。以太网交换机对工作站是透明的，因此管理开销低廉，简化了网络结点的增加、移动和网络变化的操作。

2、原理

以太网交换机的原理是，它检测从以太端口来的数据帧的源和目的地的MAC (介质访问层） 地址，然后与系统内部的动态查找表（自学习）进行比较，若数据帧的MAC 地址不在查找表中，则将该地址加入查找表，并将数据帧发送给相应的目的端口。

3、特点

以太网交换机的特点如下：

1. 以太网交换机的每个端口都直接与单台主机相连（普通网桥的端口往往连接到以太网的一个网段），并且一般都工作在全双工方式。
2. 以太网交换机能同时连通许多对端口，使每对相互通信的主机都能像独占通信媒体那样，无碰撞地传输数据。
3. 以太网交换机也是一种即插即用设备（和透明网桥一样），其内部的帧的转发表也是通过自学习算法自动地逐渐建立起来的。
4. 以太网交换机由于使用了专用的交换结构芯片，因此交换速率较高。
5. 以太网交换机独占传输媒体的带宽。

> ❝ 对于普通l0Mb/s 的共享式以太网，若共有N 个用户，则每个用户占有的平均带宽只有总带 宽(l0Mb/s) 的1/N。在使用以太网交换机时，虽然从每个端口到主机的带宽还是l0Mb/s, 但由于一个用户在通信时是独占而不是和其他网络用户共享传输媒体的带宽，因此拥有N 对端口的交换机的总容量为N*10Mb/s 。这正是交换机的最大优点。
> ❞

以太网交换机一般都具有多种速率的端口，例如可以具有l0Mb/s 、l00Mb/s 和lGb/s 的端口的各种组合，因此大大方便了各种不同情况的用户。

4、两种交换模式

目前，以太网交换机主要采用两种交换模式，即直通式和存储转发式。

1. 直通式交换机只检查帧的目的地址，这使得帧在接收后几乎能马上被传出去。这种方式速度快，但缺乏智能性和安全性，也无法支持具有不同速率的端门的交换。
2. 存储转发式交换机先将接收到的帧缓存到高速缓存器中，并检查数据是否正确，确认无误后通过查找表转换成输出端口将该帧发送出去。如果发现帧有错，那么就将其丢弃。存储转发式的优点是可靠性高，并能支持不同速率端口间的转换，缺点是延迟较大。

### **3.网络层设备**

路由器的组成和功能

路由器是一种具有多个输入／输出端口的专用计算机，其任务是连接不同的网络（连接异构网络）并完成路由转发。在多个逻辑网络（即多个广播域）互联时必须使用路由器。

当源主机要向目标主机发送数据报时，路由器先检查源主机与目标主机是否连接在同一个网 络上。如果源主机和目标主机在同一个网络上，那么直接交付而无须通过路由器。如果源主机和目标主机不在同一个网络上，那么路由器按照转发表（路由表）指出的路由将数据报转发给下一个路由器，这称为间接交付。可见，在同一个网络中传递数据无须路由器的参与，而跨网络通信必须通过路由器进行转发。例如，路由器可以连接不同的LAN, 连接不同的VLAN, 连接不同的WAN, 或者把LAN 和WAN 互联起来。路由器隔离了广播域。

从结构上看，路由器由路由选择和分组转发两部分构成，如图所示：



![339fd27cbfec19bfa5681223dc33a577.png](https://img-blog.csdnimg.cn/img_convert/339fd27cbfec19bfa5681223dc33a577.png)

而从模型的角度看，路由器是网络层设备，它实现了网络模型的下三层，即物理层、数据链路层和网络层。

> ❝ 【注意】如果一个存储转发设备实现了某个层次的功能，那么它就可以互联两个在该层次上使用不同协议的网段（网络）。如果网桥实现了物理层和数据链路层，那么网桥可以互联两个物理层和数据链路层不同的网段；但中继器实现了物理层后，却不能互联两个物理层同的网段，这是因为中继器不是存储转发设备，它属于直通式设备。
> ❞

路由选择部分也称控制部分，其核心构件是路由选择处理机。路由选择处理机的任务是根据 所选定的路由选择协议构造出路由表，同时经常或定期地和其他相邻路由器交换路由信息而不断更新和维护路由表。

分组转发部分由三部分组成：交换结构、一组输入端口和一组输出端口。输入端口在从物理 层接收到的比特流中提取出链路层帧，进而从帧中提取出网络层数据报，输出端口则执行恰好相反的操作。交换结构是路由器的关键部件，它根据转发表对分组进行处理，将某个输入端口进入的分组从一个合适的输出端口转发出去。有三种常用的交换方法：通过存储器进行交换、通过总线进行交换和通过互联网络进行交换。交换结构本身就是一个网络。

> ❝ 路由器和网桥的重要区别是：网桥与高层协议无关，而路由器是面向协议的，它依据网络地 址进行操作，并进行路径选择、分段、帧格式转换、对数据报的生存时间和流量进行控制等。现今的路由器一般都提供多种协议的支持，包括OSI 、TCP/IP 、IPX 等。
> ❞

------

路由表与路由转发

1. 路由表是根据路由选择算法得出的，主要用途是路由选择。一般标准的路由表有4 个项目：目的网络IP 地址、子网掩码、下一跳IP 地址、接口。在如图所示的网络拓扑中，Rl的路表见表, 该路由表包含到互联网的默认路由。



![ddc3b60001e27a79fcea5067d63996e1.png](https://img-blog.csdnimg.cn/img_convert/ddc3b60001e27a79fcea5067d63996e1.png)

1. 转发表是从路由表得出的，其表项和路由表项有直接的对应关系。但转发表的格式和路由表的格式不同，其结构应使查找过程最优化（而路由表则需对网络拓扑变化的计算最优化）。转发表中含有一个分组将要发往的目的地址，以及分组的下一跳（即下一步接收者的目的地址，实际为MAC 地址）。为了减少转发表的重复项目，可以使用一个默认路由代替所有具有相同“下一跳”的项目，并将默认路由设置得比其他项目的优先级低，如图所示。路由表总是用软件来实现的；转发表可以用软件来实现，甚至也可以用特殊的硬件来实现。



![7c02961ac79a737c584184b5c5b07faa.png](https://img-blog.csdnimg.cn/img_convert/7c02961ac79a737c584184b5c5b07faa.png)

> ❝ 【注意】转发和路由选择的区别：“转发”是路由器根据转发表把收到的IP 数据报从合适的端口转发出去，它仅涉及一个路由器。而“路由选择”则涉及很多路由器，路由表是许多路由器协同工作的结果。这些路由器按照复杂的路由算法，根据从各相邻路由器得到的关于网络拓扑的变化情况，动态的改变所选择的路由，并由此构造出整个路由表。
> ❞

### **4.网关**

大家都知道，从一个房间走到另一个房间，必然要经过一扇门。同样，从一个网络向另一个网络发送信息，也必须经过一道“关口”，这道关口就是网关。顾名思义，网关（Gateway） 就是一个网络连接到另一个网络的“关口”。也就是网络关卡。

网关(Gateway)又称网间连接器、协议转换器。默认网关在网络层上以实现网络互连，是最复杂的网络互连设备，仅用于两个高层协议不同的网络互连。网关的结构也和路由器类似，不同的是互连层。网关既可以用于广域网互连，也可以用于局域网互连。

> ❝ 【说明】：由于历史的原因，许多有关TCP/IP的文献曾经把网络层使用的路由器称为网关，在今天很多局域网采用都是路由来接入网络，因此通常指的网关就是路由器的IP！
> ❞

在OSI中，网关有两种：一种是面向连接的网关，一种是无连接的网关。当两个子网之间有一定距离时，往往将一个网关分成两半，中间用一条链路连接起来，我们称之为半网关。

按照不同的分类标准，网关也有很多种。TCP/IP协议里的网关是最常用的，在这里我们所讲的“网关”均指TCP/IP协议下的网关。

那么网关到底是什么呢？网关实质上是一个网络通向其他网络的IP地址。比如有网络A和网络B，网络A的IP地址范围为“192.168.1.1~192. 168.1.254”，子网掩码为255.255.255.0；网络B的IP地址范围为“192.168.2.1~192.168.2.254”，子网掩码为255.255.255.0。在没有路由器的情况下，两个网络之间是不能进行TCP/IP通信的，即使是两个网络连接在同一台交换机（或集线器）上，TCP/IP协议也会根据子网掩码（255.255.255.0）与主机的IP 地址作 “与” 运算的结果不同判定两个网络中的主机处在不同的网络里。而要实现这两个网络之间的通信，则必须通过网关。如果网络A中的主机发现数据包的目的主机不在本地网络中，就把数据包转发给它自己的网关，再由网关转发给网络B的网关，网络B的网关再转发给网络B的某个主机。

所以说，只有设置好网关的IP地址，TCP/IP协议才能实现不同网络之间的相互通信。那么这个IP地址是哪台机器的IP地址呢？网关的IP地址是具有路由功能的设备的IP地址，具有路由功能的设备有路由器、启用了路由协议的服务器（实质上相当于一台路由器）、代理服务器（也相当于一台路由器）。

网关也被称为 IP路由器。

> ❝ 【举个栗子】： 假设你的名字叫小不点(很小)，你住在一个大院子里，你的邻居有很多小伙伴，父母是你的网关。当你想跟院子里的某个小伙伴玩，只要你在院子里大喊一声他的名字，他听到了就会回应你，并且跑出来跟你玩。
> 但是你家长不允许你走出大门，你想与外界发生的一切联系，都必须由父母（网关）用电话帮助你联系。假如你想找你的同学小明聊天，小明家住在很远的另外一个院子里，他家里也有父母（小明的网关）。
> 但是你不知道小明家的电话号码，不过你的班主任老师有一份你们班全体同学的名单和电话号码对照表，你的老师就是你的DNS服务器。
> 于是你在家里和父母有了下面的对话：
> 小不点：妈妈(或爸爸),我想找班主任查一下小明的电话号码行吗？
> 家长：好，你等着。（接着你家长给你的班主任挂了一个电话，问清楚了小明的电话）问到了，他家的号码是211.99.99.99
> 小不点：太好了！妈(或爸),我想找小明，你再帮我联系一下小明吧。
> 家长：没问题。（接着家长向电话局发出了请求接通小明家电话的请求，最后一关当然是被转接到了小明家家长那里，然后他家长把电话给转到小明）.
> 就这样你和小明取得了联系。
> 如果搞清了什么是网关，默认网关也就好理解了。就好像一个房间可以有多扇门一样，一台主机可以有多个网关。默认网关的意思是一台主机如果找不到可用的网关，就把数据包发给默认指定的网关，由这个网关来处理数据包。默认网关。默认网关一般填写192.168.x.1
> ❞